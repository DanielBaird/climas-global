!function e(t,n,i){function r(o,s){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);throw new Error("Cannot find module '"+o+"'")}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return r(n?n:e)},c,c.exports,e,t,n,i)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e){e("./reports/main")},{"./reports/main":2}],2:[function(e){(function(){var t;window.console||(window.console={log:function(){return{}}}),t=e("./views/app"),$(function(){var e;return e=new t,e.render()})}).call(this)},{"./views/app":4}],3:[function(){(function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};Array.prototype.forEach||(Array.prototype.forEach=function(t,n){var i,r,a,o;for(o=[],i=r=0,a=this.length;a>=0?a>=r:r>=a;i=a>=0?++r:--r)o.push(e.call(this,i)>=0?t.call(n,this[i],i,this):void 0);return o}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t,n,i;for(t=n=0,i=this.length;i>=0?i>=n:n>=i;t=i>=0?++n:--n)if(this[t]===e)return t;return-1})}).call(this)},{}],4:[function(e,t){(function(){var n,i;e("../util/shims"),i=function(e,t){var n,i,r,a;return n=["verydebug","debug","message","warning"],r="message",t||(t="debug"),a=n.indexOf(r),i=n.indexOf(t),a>i?void 0:console.log(e+""===e?"["+t+"] "+e:e)},n=Backbone.View.extend({tagName:"form",className:"",id:"reportform",dataUrl:""+location.protocol+"//"+location.host+"/data",rasterApiUrl:""+location.protocol+"//localhost:10600/api/raster/1/wms_data_url",trackSplitter:!1,trackPeriod:100,events:{"change .sectionselector input":"updateSectionSelection","change .regionselect input":"updateRegionSelection","change .regionselect select":"updateRegionSelection","change .yearselect input":"updateYearSelection","click .getreport":"getReport"},initialize:function(){return i("AppView.initialize"),_.bindAll.apply(_,[this].concat(_.functions(this))),this.fetchReportSections(),this.fetchRegions(),this.fetchYears(),this.updateSummary()},render:function(){return i("AppView.render"),this.$el.append(n.templates.layout({})),$("#contentwrap .maincontent").append(this.$el)},getReport:function(){var e;return i("AppView.getReport"),this.$("#reportform").remove(),e=[],e.push('<form action="/regionreport" method="get" id="reportform">'),e.push('<input type="hidden" name="year" value="'+this.selectedYear+'">'),e.push('<input type="hidden" name="regiontype" value="'+this.selectedRegionType+'">'),e.push('<input type="hidden" name="region" value="'+this.selectedRegion+'">'),e.push('<input type="hidden" name="sections" value="'+this.selectedSections.join(" ")+'">'),e.push("</form>"),this.$el.append(e.join("\n")),this.$("#reportform").submit()},fetchReportSections:function(){var e;return i("AppView.fetchReportSections"),e=$.ajax(this.dataUrl+"/reportsections"),e.done(function(e){return function(t){var n;return e.possibleSections=t.sections,n=e.$(".sectionselect"),n.empty().removeClass("loading"),e.buildReportSectionList(e.possibleSections,n)}}(this)),e.promise()},buildReportSectionList:function(e,t){return i("AppView.buildReportSectionList"),$.each(e,function(e){return function(i,r){var a,o;return a=$(n.templates.sectionSelector(r)),$(t).append(a),r.sections.length>0?(o=$(n.templates.subsections()),e.buildReportSectionList(r.sections,o),$(a).addClass("hassubsections").append(o)):void 0}}(this)),this.updateSummary()},updateSectionSelection:function(){return i("AppView.updateSectionSelection"),this.handleSectionSelection(this.possibleSections)},handleSectionSelection:function(e){return i("AppView.handleSectionSelection"),$.each(e,function(e){return function(t,n){var i,r,a;return r=e.$("#section-"+n.id.replace(/\./g,"\\.")),i=r.find("input"),i.prop("checked")?r.removeClass("unselected"):r.addClass("unselected"),(null!=(a=n.sections)?a.length:void 0)>0?e.handleSectionSelection(n.sections,n.id):void 0}}(this)),this.updateSummary()},fetchRegions:function(){var e;return i("AppView.fetchRegions"),e=$.Deferred(),e.done(function(e){return function(t){return e.buildRegionList(t)}}(this)),setTimeout(function(){return e.resolve({regiontypes:[{id:"nrm",name:"NRM region",regions:[{id:"NRM_ACT",name:"ACT"},{id:"NRM_Adelaide_and_Mount_Lofty_Ranges",name:"Adelaide and Mount Lofty Ranges"},{id:"NRM_Alinytjara_Wilurara",name:"Alinytjara Wilurara"},{id:"NRM_Avon",name:"Avon"},{id:"NRM_Border_Rivers-Gwydir",name:"Border Rivers-Gwydir"},{id:"NRM_Border_Rivers_Maranoa-Balonne",name:"Border Rivers Maranoa-Balonne"},{id:"NRM_Burdekin",name:"Burdekin"},{id:"NRM_Burnett_Mary",name:"Burnett Mary"},{id:"NRM_Cape_York",name:"Cape York"},{id:"NRM_Central_West",name:"Central West"},{id:"NRM_Condamine",name:"Condamine"},{id:"NRM_Cooperative_Management_Area",name:"Cooperative Management Area"},{id:"NRM_Corangamite",name:"Corangamite"},{id:"NRM_Desert_Channels",name:"Desert Channels"},{id:"NRM_East_Gippsland",name:"East Gippsland"},{id:"NRM_Eyre_Peninsula",name:"Eyre Peninsula"},{id:"NRM_Fitzroy",name:"Fitzroy"},{id:"NRM_Glenelg_Hopkins",name:"Glenelg Hopkins"},{id:"NRM_Goulburn_Broken",name:"Goulburn Broken"},{id:"NRM_Hawkesbury-Nepean",name:"Hawkesbury-Nepean"},{id:"NRM_Hunter-Central_Rivers",name:"Hunter-Central_Rivers"},{id:"NRM_Kangaroo_Island",name:"Kangaroo Island"},{id:"NRM_Lachlan",name:"Lachlan"},{id:"NRM_Lower_Murray_Darling",name:"Lower Murray Darling"},{id:"NRM_Mackay_Whitsunday",name:"Mackay Whitsunday"},{id:"NRM_Mallee",name:"Mallee"},{id:"NRM_Murray",name:"Murray"},{id:"NRM_Murrumbidgee",name:"Murrumbidgee"},{id:"NRM_Namoi",name:"Namoi"},{id:"NRM_North",name:"North"},{id:"NRM_North_Central",name:"North Central"},{id:"NRM_North_East",name:"North East"},{id:"NRM_North_West",name:"North West"},{id:"NRM_Northern_Agricultural",name:"Northern Agricultural"},{id:"NRM_Northern_Gulf",name:"Northern Gulf"},{id:"NRM_Northern_Rivers",name:"Northern Rivers"},{id:"NRM_Northern_Territory",name:"Northern Territory"},{id:"NRM_Northern_and_Yorke",name:"Northern and Yorke"},{id:"NRM_Perth",name:"Perth"},{id:"NRM_Port_Phillip_and_Western_Port",name:"Port Phillip and Western Port"},{id:"NRM_Rangelands",name:"Rangelands"},{id:"NRM_South",name:"South"},{id:"NRM_South_Australian_Arid_Lands",name:"South Australian Arid Lands"},{id:"NRM_South_Australian_Murray_Darling_Basin",name:"South Australian Murray Darling Basin"},{id:"NRM_South_Coast",name:"South Coast"},{id:"NRM_South_East",name:"South East"},{id:"NRM_South_East_Queensland",name:"South East Queensland"},{id:"NRM_South_West",name:"South West"},{id:"NRM_South_West_Queensland",name:"South West Queensland"},{id:"NRM_Southern_Gulf",name:"Southern Gulf"},{id:"NRM_Southern_Rivers",name:"Southern Rivers"},{id:"NRM_Sydney_Metro",name:"Sydney Metro"},{id:"NRM_Torres_Strait",name:"Torres Strait"},{id:"NRM_West_Gippsland",name:"West Gippsland"},{id:"NRM_Western",name:"Western"},{id:"NRM_Wet_Tropics",name:"Wet Tropics"},{id:"NRM_Wimmera",name:"Wimmera"}]},{id:"state",name:"State, territory",regions:[{id:"State_Australian_Capital_Territory",name:"ACT"},{id:"State_New_South_Wales",name:"New South Wales"},{id:"State_Northern_Territory",name:"Northern Territory"},{id:"State_Queensland",name:"Queensland"},{id:"State_South_Australia",name:"South Australia"},{id:"State_Tasmania",name:"Tasmania"},{id:"State_Victoria",name:"Victoria"},{id:"State_Western_Australia",name:"Western Australia"}]}]})},500+500*Math.random()),e.promise()},buildRegionList:function(e){var t;return i("AppView.buildRegionList"),this.regions=e.regiontypes,t=this.$(".regionselect"),t.empty().removeClass("loading"),$.each(this.regions,function(){return function(e,i){var r,a;return i.optionList=[function(){var e,t,a,o;for(a=i.regions,o=[],e=0,t=a.length;t>e;e++)r=a[e],o.push(n.templates.regionSelector(r));return o}()].join("\n"),a=$(n.templates.regionTypeSelector(i)),t.append(a)}}(this)),this.updateSummary()},updateRegionSelection:function(){var e;return i("AppView.updateRegionSelection"),e=this.$("[name=regiontype]:checked").val(),$.each(this.regions,function(t){return function(n,i){var r;return r=t.$("#regiontype-"+i.id),e===i.id?(r.addClass("typeselected"),t.selectedRegionType=i.id,t.selectedRegion=$(r.find("select")).val(),""===t.selectedRegion?r.removeClass("regionselected"):(r.addClass("regionselected"),t.selectedRegionInfo=_.find(i.regions,function(e){return e.id===t.selectedRegion}))):r.removeClass("typeselected")}}(this)),this.updateSummary()},fetchYears:function(){var e;return i("AppView.fetchYears"),e=$.Deferred(),e.done(function(e){return function(t){return e.buildYearList(t)}}(this)),setTimeout(function(){return e.resolve({years:["2015","2025","2035","2045","2055","2065","2075","2085"]})},500+500*Math.random()),e.promise()},buildYearList:function(e){var t;return i("AppView.buildYearList"),this.years=e.years,t=this.$(".yearselect"),t.empty().removeClass("loading"),$.each(this.years,function(){return function(e,i){return t.append(n.templates.yearSelector({year:i}))}}(this)),this.updateSummary()},updateYearSelection:function(){return i("AppView.updateYearSelection"),this.selectedYear=this.$("[name=yearselector]:checked").val(),$.each(this.years,function(e){return function(t,n){var i;return i=e.$("#year-"+n),e.selectedYear===n?i.addClass("yearselected"):i.removeClass("yearselected")}}(this)),this.updateSummary()},sectionId:function(e){return i("AppView.sectionId"),$(e).find("input").attr("value")},sectionName:function(e){return i("AppView.sectionName"),this.sectionInfo(e).name},sectionInfo:function(e){var t,n,r;return i("AppView.sectionInfo"),r=$(e).parents(".sectionselector"),n=r.map(function(e){return function(t,n){return e.sectionId(n)}}(this)).get().reverse(),n.push(this.sectionId(e)),this.selectedSections.push(n.join(".")),t={sections:this.possibleSections},n.forEach(function(e){return t=_.filter(t.sections,function(t){return t.id===e})[0]}),t},subSectionList:function(e){var t,n;return i("AppView.sectionList"),t=[],n=$(e).children(".subsections"),n.children(".sectionselector").not(".unselected").each(function(e){return function(n,i){var r,a;return r=e.sectionName(i),a=e.subSectionList(i),""!==a&&(r=r+" ("+a+")"),t.push(r)}}(this)),t.join(", ")},updateSummary:function(){var e,t,r,a,o;return i("AppView.updateSummary"),r=this.$(".sectionselect > .sectionselector").not(".unselected"),this.selectedSections=[],t=[],r.each(function(e){return function(n,i){var r,a;return r=e.sectionName(i),a=e.subSectionList(i),""!==a&&(r=r+": "+a.toLowerCase()),t.push(r+".")}}(this)),e="",t.length>0&&(e="<li>"+t.join("</li><li>")+"</li>"),a={regionName:null!=(o=this.selectedRegionInfo)?o.name:void 0,year:this.selectedYear,content:e},i(t),i(a),this.$(".reviewblock").html(n.templates.reviewBlock(a)),this.$(".reviewblock").toggleClass("regionselected",void 0!==this.selectedRegionInfo),this.$(".reviewblock").toggleClass("yearselected",void 0!==this.selectedYear)}},{templates:{layout:_.template('<div class="reviewblock"></div>\n<div class="formblock">\n    <h1>Report on</h1>\n    <div class="loading select regionselect">loading available regions..</div>\n\n    <h1>In the year</h1>\n    <div class="loading select yearselect">loading available years..</div>\n\n    <h1>Including</h1>\n    <div class="loading select sectionselect">loading available sections..</div>\n</div>'),reviewBlock:_.template('<h1>Selected Report</h1>\n<p class="coverage">Covers\n    <% if (regionName) { %><%= regionName %><% } else { %><em>(unspecified region)</em><% } %>\n    in\n    <% if (year) { %><%= year %>.<% } else { %><em>(unspecified year)</em>.<% } %>\n</p>\n<ul class="contents"><%= content %></ul>\n<button type="button" class="getreport">download report</button>'),reviewContentItem:_.template("<li>item</li>"),regionTypeSelector:_.template('<div class="regiontypeselector" id="regiontype-<%= id %>">\n    <label class="name"><input\n        class="regiontype"\n        name="regiontype"\n        type="radio"\n        value="<%= id %>"\n    /> <%= name %>\n    </label>\n    <div class="regionselectorwrapper"><select class="regionselector">\n        <option value="" disabled="disabled" selected="selected">select a region&hellip;</option>\n        <%= optionList %>\n    </select></div>\n</div>'),regionSelector:_.template('<option value="<%= id %>"><%= name %></option>'),yearSelector:_.template('<div class="yearrow" id="year-<%= year %>">\n    <label class="name"><input\n        class="yearselector"\n        name="yearselector"\n        type="radio"\n        value="<%= year %>"\n    /> <%= year %></label>\n</div>'),sectionSelector:_.template('<div class="sectionselector" id="section-<%= id %>">\n    <label class="name"\n        <% if (presence == \'required\') { print(\'title="This section is required"\'); } %>\n    ><input\n        type="checkbox"\n        value="<%= id %>"\n        checked="checked"\n        <% if (presence == \'required\') { print(\'disabled="disabled"\'); } %>\n    /> <%= name %></label>\n    <p class="description"><%= description %></p>\n\n</div>'),subsections:_.template('<div class="subsections clearfix">\n</div>')}}),t.exports=n}).call(this)},{"../util/shims":3}]},{},[1]);